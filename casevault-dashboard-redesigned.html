<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settlement Dashboard | CaseVault Insights</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/casevault-insights/casevault.css">
</head>
<body>
    <!-- Access Locked Overlay -->
    <div id="lockedOverlay" class="cv-overlay cv-hidden">
        <div class="cv-overlay__card">
            <div class="cv-overlay__icon">
                <i class="fas fa-lock" style="font-size: 28px; color: var(--cv-blue-400);"></i>
            </div>
            <h2 id="lockTitle" class="cv-display" style="font-size: var(--cv-text-2xl); margin-bottom: var(--cv-space-md); color: var(--cv-text-primary);">
                Subscribe to Continue
            </h2>
            <p id="lockMessage" class="cv-text-secondary" style="margin-bottom: var(--cv-space-xl); line-height: 1.6;">
                Your 10-minute preview has expired. Submit another case for 10 more minutes, or subscribe for unlimited access to settlement benchmarks.
            </p>
            <a href="/casevault-contribute.html" id="lockCTA" class="cv-btn cv-btn-primary cv-btn--lg cv-btn--full cv-mb-lg">
                Contribute Another Case →
            </a>
            <hr class="cv-divider">
            <p class="cv-text-muted" style="font-size: var(--cv-text-sm); margin-bottom: var(--cv-space-sm);">
                Want unlimited access?
            </p>
            <a href="/contact.html" class="cv-text-blue" style="font-weight: 600;">
                Subscribe to CaseVault Pro →
            </a>
        </div>
    </div>

    <!-- Timer Banner -->
    <div class="cv-timer-banner">
        <span>⏱️ Dashboard access expires in: <strong id="timeRemaining">10:00</strong></span>
        <a href="/casevault-contribute.html" id="extendAccess">Submit another case to extend</a>
    </div>

    <!-- Navigation -->
    <nav class="cv-nav">
        <div class="cv-nav__inner">
            <a href="/" class="cv-nav__logo">
                <div class="cv-nav__logo-icon">CV</div>
                <span>CaseVault</span>
            </a>
            <ul class="cv-nav__links">
                <li><a href="/" class="cv-nav__link">Home</a></li>
                <li><a href="/casevault-calculator.html" class="cv-nav__link">Calculator</a></li>
                <li><a href="/casevault-dashboard.html" class="cv-nav__link cv-nav__link--active">Dashboard</a></li>
                <li><a href="/contact.html" class="cv-nav__link">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- Dashboard Header -->
    <section class="cv-hero" style="padding: var(--cv-space-3xl) 0;">
        <div class="cv-container">
            <div class="cv-badge cv-badge--blue cv-mb-lg">
                <i class="fas fa-chart-line"></i>
                Live Settlement Intelligence
            </div>
            <h1 class="cv-hero__title cv-display" style="font-size: var(--cv-text-5xl);">
                Settlement Dashboard
            </h1>
            <p class="cv-hero__subtitle">
                Live benchmark data from <strong class="cv-text-blue">1,756</strong> personal injury settlements across New England
            </p>
        </div>
    </section>

    <!-- Main Dashboard -->
    <div class="cv-container" style="margin-bottom: var(--cv-space-4xl);">

        <!-- Filters -->
        <div class="cv-card cv-mb-xl">
            <div class="cv-label cv-mb-md">Filter Benchmarks</div>
            <div class="cv-filters">
                <div class="cv-filter-group">
                    <label>State</label>
                    <select id="filterState">
                        <option value="all">All States</option>
                        <option value="MA">Massachusetts</option>
                        <option value="CT">Connecticut</option>
                        <option value="RI">Rhode Island</option>
                        <option value="NH">New Hampshire</option>
                    </select>
                </div>
                <div class="cv-filter-group">
                    <label>Case Type</label>
                    <select id="filterType">
                        <option value="all">All Types</option>
                        <option value="car_accident">Car Accident</option>
                        <option value="slip_fall">Slip & Fall</option>
                        <option value="medical_malpractice">Medical Malpractice</option>
                        <option value="workplace">Workplace</option>
                    </select>
                </div>
                <div class="cv-filter-group">
                    <label>Settlement Range</label>
                    <select id="filterRange">
                        <option value="all">All Amounts</option>
                        <option value="0-25k">$0 - $25K</option>
                        <option value="25k-50k">$25K - $50K</option>
                        <option value="50k-100k">$50K - $100K</option>
                        <option value="100k+">$100K+</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="cv-grid cv-grid-3 cv-mb-xl">
            <div class="cv-card cv-card--highlight">
                <div class="cv-label cv-mb-sm">Total Settlements</div>
                <div class="cv-stat__value cv-stat__value--large cv-stat__value--blue" id="totalCases">1,756</div>
                <div class="cv-stat__label">Across 4 states</div>
            </div>
            <div class="cv-card">
                <div class="cv-label cv-mb-sm">Average Settlement</div>
                <div class="cv-stat__value cv-stat__value--large cv-stat__value--blue cv-mono" id="avgSettlement">$52,400</div>
                <div class="cv-stat__label">Median: $38,200</div>
            </div>
            <div class="cv-card">
                <div class="cv-label cv-mb-sm">Highest Settlement</div>
                <div class="cv-stat__value cv-stat__value--large cv-stat__value--gold cv-mono" id="maxSettlement">$2.4M</div>
                <div class="cv-stat__label">Medical malpractice - MA</div>
            </div>
        </div>

        <!-- Settlement Distribution by State -->
        <div class="cv-card cv-mb-xl">
            <h3 class="cv-display" style="font-size: var(--cv-text-xl); margin-bottom: var(--cv-space-lg); color: var(--cv-text-primary);">
                Settlements by State
            </h3>

            <div class="cv-bar">
                <div class="cv-bar__header">
                    <span class="cv-bar__label">Massachusetts</span>
                    <span class="cv-bar__count">205 cases</span>
                </div>
                <div class="cv-bar__track">
                    <div class="cv-bar__fill" style="width: 100%;"></div>
                </div>
            </div>

            <div class="cv-bar">
                <div class="cv-bar__header">
                    <span class="cv-bar__label">Connecticut</span>
                    <span class="cv-bar__count">136 cases</span>
                </div>
                <div class="cv-bar__track">
                    <div class="cv-bar__fill" style="width: 66%;"></div>
                </div>
            </div>

            <div class="cv-bar">
                <div class="cv-bar__header">
                    <span class="cv-bar__label">Rhode Island</span>
                    <span class="cv-bar__count">56 cases</span>
                </div>
                <div class="cv-bar__track">
                    <div class="cv-bar__fill" style="width: 27%;"></div>
                </div>
            </div>

            <div class="cv-bar">
                <div class="cv-bar__header">
                    <span class="cv-bar__label">New Hampshire</span>
                    <span class="cv-bar__count">4 cases</span>
                </div>
                <div class="cv-bar__track">
                    <div class="cv-bar__fill" style="width: 2%; background: linear-gradient(90deg, var(--cv-gold-500), var(--cv-gold-400));"></div>
                </div>
            </div>
        </div>

        <!-- Recent Settlements Table -->
        <div class="cv-card cv-mb-xl">
            <div class="cv-flex-between cv-mb-lg">
                <h3 class="cv-display" style="font-size: var(--cv-text-xl); color: var(--cv-text-primary);">
                    Recent Settlements
                </h3>
                <div class="cv-badge cv-badge--green">
                    <i class="fas fa-check-circle"></i>
                    Live Data
                </div>
            </div>

            <table class="cv-table">
                <thead>
                    <tr>
                        <th>State</th>
                        <th>Case Type</th>
                        <th>Amount</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody id="settlementsTable">
                    <tr>
                        <td><span class="cv-badge cv-badge--blue">MA</span></td>
                        <td>Car Accident</td>
                        <td class="cv-table__amount">$85,000</td>
                        <td class="cv-text-muted">2026-02-05</td>
                    </tr>
                    <tr>
                        <td><span class="cv-badge cv-badge--blue">CT</span></td>
                        <td>Slip & Fall</td>
                        <td class="cv-table__amount">$42,500</td>
                        <td class="cv-text-muted">2026-02-04</td>
                    </tr>
                    <tr>
                        <td><span class="cv-badge cv-badge--blue">MA</span></td>
                        <td>Medical Malpractice</td>
                        <td class="cv-table__amount">$325,000</td>
                        <td class="cv-text-muted">2026-02-03</td>
                    </tr>
                    <tr>
                        <td><span class="cv-badge cv-badge--blue">RI</span></td>
                        <td>Workplace Injury</td>
                        <td class="cv-table__amount">$67,800</td>
                        <td class="cv-text-muted">2026-02-02</td>
                    </tr>
                    <tr>
                        <td><span class="cv-badge cv-badge--blue">CT</span></td>
                        <td>Car Accident</td>
                        <td class="cv-table__amount">$52,000</td>
                        <td class="cv-text-muted">2026-02-01</td>
                    </tr>
                </tbody>
            </table>
            <p class="cv-text-center cv-text-muted cv-mt-lg" style="font-size: var(--cv-text-xs);">
                Showing 5 of 1,756 total settlements
            </p>
        </div>

        <!-- Case Type & Settlement Range Breakdown -->
        <div class="cv-grid cv-grid-2 cv-mb-xl">
            <div class="cv-card">
                <h3 class="cv-display" style="font-size: var(--cv-text-xl); margin-bottom: var(--cv-space-lg); color: var(--cv-text-primary);">
                    By Case Type
                </h3>
                <table class="cv-table">
                    <tbody>
                        <tr>
                            <td>Car Accidents</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">892</span></td>
                        </tr>
                        <tr>
                            <td>Slip & Fall</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">423</span></td>
                        </tr>
                        <tr>
                            <td>Medical Malpractice</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">187</span></td>
                        </tr>
                        <tr>
                            <td>Workplace Injury</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">254</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="cv-card">
                <h3 class="cv-display" style="font-size: var(--cv-text-xl); margin-bottom: var(--cv-space-lg); color: var(--cv-text-primary);">
                    Settlement Ranges
                </h3>
                <table class="cv-table">
                    <tbody>
                        <tr>
                            <td>Under $25K</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">614</span></td>
                        </tr>
                        <tr>
                            <td>$25K - $50K</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">521</span></td>
                        </tr>
                        <tr>
                            <td>$50K - $100K</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-blue" style="font-weight: 600;">387</span></td>
                        </tr>
                        <tr>
                            <td>Over $100K</td>
                            <td class="cv-text-right"><span class="cv-mono cv-text-gold" style="font-weight: 600;">234</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- CTA to extend access -->
        <div class="cv-card" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(6, 182, 212, 0.1)); border: 1px solid var(--cv-blue-border); text-align: center; padding: var(--cv-space-3xl);">
            <div style="font-size: 48px; margin-bottom: var(--cv-space-md);">⏰</div>
            <h2 class="cv-display" style="font-size: var(--cv-text-2xl); margin-bottom: var(--cv-space-md); color: var(--cv-text-primary);">
                Need More Time?
            </h2>
            <p class="cv-text-secondary cv-mb-xl" style="font-size: var(--cv-text-lg); max-width: 560px; margin-left: auto; margin-right: auto;">
                Submit another settlement case to extend your access for 10 more minutes.
            </p>
            <a href="/casevault-contribute.html" class="cv-btn cv-btn-primary cv-btn--lg">
                <i class="fas fa-plus-circle"></i>
                Contribute Another Case
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="cv-footer">
        <div class="cv-container">
            <div class="cv-footer__inner">
                <div class="cv-footer__copy">
                    © 2026 CaseVault by AIBridges. All rights reserved.
                </div>
                <div class="cv-footer__links">
                    <a href="/privacy.html" class="cv-footer__link">Privacy Policy</a>
                    <a href="/terms.html" class="cv-footer__link">Terms of Service</a>
                    <a href="/contact.html" class="cv-footer__link">Contact</a>
                </div>
            </div>
            <div class="cv-footer__disclaimer">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Legal Disclaimer:</strong> This data is for informational purposes only and does not constitute legal advice. Settlement values vary based on individual case circumstances. Consult with a licensed attorney for case-specific guidance.
            </div>
        </div>
    </footer>

    <script>
        // Auth Check - Verify access token from contribution
        async function checkAuth() {
            const accessToken = localStorage.getItem('casevault_access_token');
            const expiresAt = parseInt(localStorage.getItem('casevault_access_expires'));
            const userName = localStorage.getItem('casevault_user_name');
            const contributed = localStorage.getItem('casevault_contributed');

            // Validate token exists and hasn't expired
            if (!accessToken || !expiresAt || Date.now() > expiresAt) {
                // Clean up expired tokens
                if (accessToken && expiresAt && Date.now() > expiresAt) {
                    localStorage.removeItem('casevault_access_token');
                    localStorage.removeItem('casevault_access_expires');
                }

                const overlay = document.getElementById('lockedOverlay');
                overlay.classList.remove('cv-hidden');

                if (!userName) {
                    // Never completed intake
                    document.getElementById('lockTitle').textContent = 'Access Required';
                    document.getElementById('lockMessage').textContent = 'Complete the intake form and contribute 1 settlement case to unlock your free 10-minute dashboard preview.';
                    document.getElementById('lockCTA').textContent = 'Get Started Free →';
                    document.getElementById('lockCTA').href = '/casevault-intake.html';
                } else if (contributed) {
                    // Token expired after previous contribution
                    document.getElementById('lockTitle').textContent = 'Subscribe to Continue';
                    document.getElementById('lockMessage').textContent = 'Your 10-minute preview has expired. Submit another case for 10 more minutes, or subscribe for unlimited access to settlement benchmarks.';
                    document.getElementById('lockCTA').textContent = 'Contribute Another Case →';
                    document.getElementById('lockCTA').href = '/casevault-contribute.html';
                } else {
                    // Filled intake but hasn't contributed
                    document.getElementById('lockTitle').textContent = 'One More Step';
                    document.getElementById('lockMessage').textContent = 'Contribute 1 settlement case to unlock your free 10-minute dashboard preview.';
                    document.getElementById('lockCTA').textContent = 'Contribute a Settlement →';
                    document.getElementById('lockCTA').href = '/casevault-contribute.html';
                }

                return false;
            }

            return true;
        }

        // Timer Countdown
        function startTimer() {
            const expiresAt = parseInt(localStorage.getItem('casevault_access_expires'));
            const banner = document.querySelector('.cv-timer-banner');

            const timerInterval = setInterval(() => {
                const now = Date.now();
                const timeLeft = expiresAt - now;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    localStorage.removeItem('casevault_access_token');
                    localStorage.removeItem('casevault_access_expires');
                    document.getElementById('lockedOverlay').classList.remove('cv-hidden');
                    return;
                }

                const minutes = Math.floor(timeLeft / 60000);
                const seconds = Math.floor((timeLeft % 60000) / 1000);
                document.getElementById('timeRemaining').textContent =
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;

                // Warning color when under 2 minutes
                if (timeLeft < 120000) {
                    banner.classList.add('cv-timer-banner--warning');
                }
            }, 1000);
        }

        // Filter functionality (placeholder - in production, fetch from API)
        document.getElementById('filterState').addEventListener('change', function() {
            console.log('Filter by state:', this.value);
            // In production: fetch filtered data from API
        });

        document.getElementById('filterType').addEventListener('change', function() {
            console.log('Filter by type:', this.value);
            // In production: fetch filtered data from API
        });

        document.getElementById('filterRange').addEventListener('change', function() {
            console.log('Filter by range:', this.value);
            // In production: fetch filtered data from API
        });

        // Initialize
        (async function() {
            const isAuthenticated = await checkAuth();
            if (isAuthenticated) {
                startTimer();
            }
        })();
    </script>
</body>
</html>
