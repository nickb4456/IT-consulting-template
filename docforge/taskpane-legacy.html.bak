<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Toolbar</title>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; padding: 16px;
            background: #fafafa;
            font-size: 14px;
        }
        h1 { font-size: 20px; color: #323130; margin: 0 0 16px; display: flex; align-items: center; gap: 8px; }
        h1::before { content: '‚öñÔ∏è'; }
        .section { background: white; border-radius: 8px; padding: 16px; margin-bottom: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .section-title { font-size: 14px; font-weight: 600; color: #605e5c; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
        button {
            width: 100%; padding: 10px 16px; margin-bottom: 8px;
            border: 1px solid #8a8886; border-radius: 4px;
            background: white; cursor: pointer; text-align: left;
            transition: all 0.15s;
        }
        button:hover { background: #f3f2f1; border-color: #323130; }
        button:active { background: #edebe9; }
        button.primary { background: #0078d4; color: white; border-color: #0078d4; }
        button.primary:hover { background: #106ebe; }
        .clause-list { max-height: 200px; overflow-y: auto; }
        .clause-item { padding: 8px 12px; border: 1px solid #e1dfdd; border-radius: 4px; margin-bottom: 6px; cursor: pointer; }
        .clause-item:hover { background: #f3f2f1; }
        .clause-item .title { font-weight: 600; color: #323130; }
        .clause-item .desc { font-size: 12px; color: #605e5c; margin-top: 2px; }
        select { width: 100%; padding: 8px; border: 1px solid #8a8886; border-radius: 4px; margin-bottom: 12px; }
        .status { padding: 12px; border-radius: 4px; margin-top: 12px; display: none; }
        .status.success { display: block; background: #dff6dd; color: #107c10; }
        .status.error { display: block; background: #fde7e9; color: #a80000; }
        .status.info { display: block; background: #deecf9; color: #0078d4; }
        .highlight-legend { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
        .legend-item { display: flex; align-items: center; gap: 4px; font-size: 12px; }
        .legend-color { width: 12px; height: 12px; border-radius: 2px; }
        .results { margin-top: 12px; padding: 12px; background: #f3f2f1; border-radius: 4px; max-height: 150px; overflow-y: auto; }
        .result-item { padding: 4px 0; border-bottom: 1px solid #e1dfdd; }
        .result-item:last-child { border-bottom: none; }
    </style>
</head>
<body>
    <h1>Legal Toolbar</h1>

    <div class="section">
        <div class="section-title">üìú Legal Clauses</div>
        <select id="clauseCategory">
            <option value="all">All Categories</option>
            <option value="contracts">Contracts</option>
            <option value="liability">Liability</option>
            <option value="ip">Intellectual Property</option>
            <option value="confidentiality">Confidentiality</option>
            <option value="termination">Termination</option>
        </select>
        <div class="clause-list" id="clauseList"></div>
    </div>

    <div class="section">
        <div class="section-title">üîç Defined Terms</div>
        <button onclick="highlightDefinedTerms()">Highlight Defined Terms</button>
        <button onclick="listDefinedTerms()">List All Defined Terms</button>
        <div class="highlight-legend">
            <div class="legend-item"><span class="legend-color" style="background:#fff3cd"></span> Defined</div>
            <div class="legend-item"><span class="legend-color" style="background:#f8d7da"></span> Undefined</div>
        </div>
        <div id="termsResults" class="results" style="display:none"></div>
    </div>

    <div class="section">
        <div class="section-title">üîó Cross-References</div>
        <button onclick="checkCrossReferences()">Check Cross-References</button>
        <button onclick="listSections()">List All Sections</button>
        <div id="xrefResults" class="results" style="display:none"></div>
    </div>

    <div class="section">
        <div class="section-title">üìù Redline Tools</div>
        <button onclick="showChanges()">Show Track Changes Summary</button>
        <button onclick="acceptAllChanges()">Accept All Changes</button>
        <button onclick="rejectAllChanges()">Reject All Changes</button>
    </div>

    <div class="section">
        <div class="section-title">‚úçÔ∏è Signature Blocks</div>
        <select id="sigType">
            <option value="single">Single Party</option>
            <option value="dual">Two Parties</option>
            <option value="corporate">Corporate</option>
            <option value="witness">With Witness</option>
            <option value="notary">With Notary</option>
        </select>
        <button class="primary" onclick="insertSignatureBlock()">Insert Signature Block</button>
    </div>

    <div id="status" class="status"></div>

    <!-- DocForge Modules -->
    <script src="modules/utils.js"></script>
    <script src="modules/numbering.js"></script>
    <script src="modules/numbering-ui.js"></script>
    <script src="modules/toc.js"></script>
    <script src="modules/toc-ui.js"></script>
    <script src="modules/xref.js"></script>
    <script src="modules/template.js"></script>
    
    <script src="taskpane.js"></script>
</body>
</html>
