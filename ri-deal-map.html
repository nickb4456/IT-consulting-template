<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rhode Island Deal Map - For Sale Properties</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #050508; }
    #map { width: 100%; height: 100vh; }
    .deal-popup { font-size: 13px; line-height: 1.5; }
    .deal-popup h3 { color: #333; margin-bottom: 5px; font-size: 14px; }
    .deal-popup .price { color: #22c55e; font-weight: bold; font-size: 16px; }
    .deal-popup .predicted { color: #666; font-size: 12px; }
    .deal-popup .score { background: #22c55e; color: white; padding: 2px 8px; border-radius: 0; font-weight: bold; display: inline-block; margin-top: 5px; }
    .deal-popup .details { color: #555; margin-top: 5px; }
    .deal-popup a { color: #22c55e; text-decoration: none; display: block; margin-top: 8px; }
    .deal-popup a:hover { text-decoration: underline; }
    .deal-popup .status { background: #22c55e; color: white; padding: 2px 6px; border-radius: 0; font-size: 10px; font-weight: bold; display: inline-block; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
    .legend { position: absolute; bottom: 30px; right: 10px; background: rgba(5,5,8,0.95); padding: 12px 16px; border-radius: 0; z-index: 1000; color: #ccc; font-size: 12px; border: 1px solid #1a1a1a; }
    .legend h4 { margin-bottom: 8px; color: #fff; }
    .legend-item { display: flex; align-items: center; margin: 4px 0; }
    .legend-dot { width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; }
    .legend .note { margin-top: 8px; font-size: 10px; color: #666; border-top: 1px solid #1a1a1a; padding-top: 8px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="legend">
    <h4>FOR SALE DEALS</h4>
    <div class="legend-item"><div class="legend-dot" style="background:#22c55e"></div> 40%+ below market</div>
    <div class="legend-item"><div class="legend-dot" style="background:#888"></div> 30-39% below</div>
    <div class="legend-item"><div class="legend-dot" style="background:#666"></div> 20-29% below</div>
    <div class="legend-item"><div class="legend-dot" style="background:#444"></div> 15-19% below</div>
    <div class="note">Active MLS listings only<br>Based on city median $/sqft</div>
  </div>
  
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([41.68, -71.51], 10);
    
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; OpenStreetMap &copy; CARTO',
      maxZoom: 19
    }).addTo(map);

    const deals = [{"address": "210 Lynch St", "city": "Providence", "price": 475000, "predicted_price": 1063406.9264069265, "deal_score": 55.3, "beds": 4, "baths": 2, "sqft": 4027.0, "yearBuilt": 1933, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/210-Lynch-St-02908/home/51695202", "lat": 41.8311158, "lng": -71.4525289}, {"address": "236 Lowell Ave", "city": "Providence", "price": 459900, "predicted_price": 894666.6666666667, "deal_score": 48.6, "beds": 4, "baths": 1.5, "sqft": 3388.0, "yearBuilt": 1930, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/236-Lowell-Ave-02909/home/51715435", "lat": 41.8155893, "lng": -71.4600851}, {"address": "199 Linwood Ave", "city": "Providence", "price": 579900, "predicted_price": 1112787.878787879, "deal_score": 47.9, "beds": 6, "baths": 3.5, "sqft": 4214.0, "yearBuilt": 1903, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/199-Linwood-Ave-02907/home/51719723", "lat": 41.8058437, "lng": -71.4320372}, {"address": "245 Manton St", "city": "Pawtucket", "price": 120000, "predicted_price": 230027.77777777778, "deal_score": 47.8, "beds": 3, "baths": 2, "sqft": 910.0, "yearBuilt": 1987, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Pawtucket/245-Manton-St-02861/home/52022995", "lat": 41.8652549, "lng": -71.3460204}, {"address": "46 E Andrew Comstock Rd", "city": "Warwick", "price": 110000, "predicted_price": 206844.8275862069, "deal_score": 46.8, "beds": 2, "baths": 1, "sqft": 750.0, "yearBuilt": 1953, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Warwick/46-Andrew-Comstock-Rd-02886/home/188314653", "lat": 41.6872752, "lng": -71.4219816}, {"address": "245 #216 Manton St", "city": "Pawtucket", "price": 135000, "predicted_price": 248733.3333333333, "deal_score": 45.7, "beds": 2, "baths": 2, "sqft": 984.0, "yearBuilt": 1979, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Pawtucket/245-Manton-St-02861/unit-216/home/52023302", "lat": 41.8652549, "lng": -71.3460204}, {"address": "979 Tollgate Unit 31 Rd", "city": "Warwick", "price": 119900, "predicted_price": 216221.7931034483, "deal_score": 44.5, "beds": 2, "baths": 1, "sqft": 784.0, "yearBuilt": 1990, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Warwick/979-Toll-Gate-Rd-02886/home/52210262", "lat": 41.712795, "lng": -71.492868}, {"address": "357 Pequot Ave", "city": "Warwick", "price": 225000, "predicted_price": 403761.1034482759, "deal_score": 44.3, "beds": 3, "baths": 1, "sqft": 1464.0, "yearBuilt": 1913, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Warwick/357-Pequot-Ave-02889/home/51759188", "lat": 41.6900618, "lng": -71.3968289}, {"address": "57 Gould St", "city": "Newport", "price": 875000, "predicted_price": 1549090.909090909, "deal_score": 43.5, "beds": 3, "baths": 2, "sqft": 2556.0, "yearBuilt": 1900, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Newport/57-Gould-St-02840/home/51749843", "lat": 41.4976697, "lng": -71.3116993}, {"address": "165 Whitford Ave", "city": "Providence", "price": 319900, "predicted_price": 554545.4545454546, "deal_score": 42.3, "beds": 3, "baths": 1, "sqft": 2100.0, "yearBuilt": 1937, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/165-Whitford-Ave-02908/home/51729309", "lat": 41.8391578, "lng": -71.4457355}, {"address": "84 Enfield Ave", "city": "Providence", "price": 600000, "predicted_price": 1021155.8441558442, "deal_score": 41.2, "beds": 5, "baths": 2.5, "sqft": 3867.0, "yearBuilt": 1927, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/84-Enfield-Ave-02908/home/51717764", "lat": 41.8459978, "lng": -71.447515}, {"address": "129 Glenbridge Ave", "city": "Providence", "price": 374900, "predicted_price": 634822.5108225108, "deal_score": 40.9, "beds": 3, "baths": 2, "sqft": 2404.0, "yearBuilt": 1950, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/129-Glenbridge-Ave-02909/home/51721729", "lat": 41.8218654, "lng": -71.4609699}, {"address": "245 80 Manton St", "city": "Pawtucket", "price": 94000, "predicted_price": 157986.1111111111, "deal_score": 40.5, "beds": 1, "baths": 1, "sqft": 625.0, "yearBuilt": 1981, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Pawtucket/245-Manton-St-02861/unit-80/home/198881986", "lat": 41.8652549, "lng": -71.3460204}, {"address": "28 Cambridge St", "city": "Providence", "price": 360000, "predicted_price": 593627.7056277057, "deal_score": 39.4, "beds": 4, "baths": 2, "sqft": 2248.0, "yearBuilt": 1920, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/28-Cambridge-St-02908/home/51697587", "lat": 41.8253905, "lng": -71.4445114}, {"address": "15 Job St", "city": "Providence", "price": 309000, "predicted_price": 507012.987012987, "deal_score": 39.1, "beds": 3, "baths": 1, "sqft": 1920.0, "yearBuilt": 1971, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/15-Job-St-02904/home/51728473", "lat": 41.8544309, "lng": -71.416069}, {"address": "1 Barway Ln", "city": "Cumberland", "price": 675000, "predicted_price": 1093186.6666666667, "deal_score": 38.3, "beds": 4, "baths": 3, "sqft": 4024.0, "yearBuilt": 1960, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Cumberland/1-Barway-Ln-02864/home/51915795", "lat": 41.9358232, "lng": -71.4262489}, {"address": "45 Harrison St", "city": "Pawtucket", "price": 499000, "predicted_price": 790688.8888888889, "deal_score": 36.9, "beds": 6, "baths": 3, "sqft": 3128.0, "yearBuilt": 1920, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Pawtucket/45-Harrison-St-02860/home/52005888", "lat": 41.8744401, "lng": -71.3896222}, {"address": "181 Heritage Dr", "city": "East Greenwich", "price": 759000, "predicted_price": 1198581.5602836881, "deal_score": 36.7, "beds": 5, "baths": 3, "sqft": 4056.0, "yearBuilt": 1966, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/East-Greenwich/181-Heritage-Dr-02818/home/51780379", "lat": 41.663805, "lng": -71.4705}, {"address": "31 Burrows St", "city": "Providence", "price": 439900, "predicted_price": 671792.2077922078, "deal_score": 34.5, "beds": 3, "baths": 1.5, "sqft": 2544.0, "yearBuilt": 2005, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/31-Burrows-St-02907/home/51724993", "lat": 41.7874831, "lng": -71.4225043}, {"address": "48 Nate Whipple Hwy", "city": "Cumberland", "price": 499900, "predicted_price": 760666.6666666667, "deal_score": 34.3, "beds": 4, "baths": 2, "sqft": 2800.0, "yearBuilt": 1960, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Cumberland/48-Nate-Whipple-Hwy-02864/home/51917043", "lat": 41.9775189, "lng": -71.454427}, {"address": "61 Whitmarsh St", "city": "Providence", "price": 520000, "predicted_price": 783757.5757575758, "deal_score": 33.7, "beds": 7, "baths": 2, "sqft": 2968.0, "yearBuilt": 1930, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/61-Whitmarsh-St-02907/home/51696912", "lat": 41.8061641, "lng": -71.4226861}, {"address": "60 Ophelia St", "city": "Providence", "price": 339900, "predicted_price": 507012.987012987, "deal_score": 33.0, "beds": 3, "baths": 1, "sqft": 1920.0, "yearBuilt": 1965, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/60-Ophelia-St-02909/home/51727286", "lat": 41.8179869, "lng": -71.4641602}, {"address": "14 Martin Ct", "city": "Pawtucket", "price": 189900, "predicted_price": 282605.55555555556, "deal_score": 32.8, "beds": 3, "baths": 1, "sqft": 1118.0, "yearBuilt": 1890, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Pawtucket/14-Martin-Ct-02860/home/52020894", "lat": 41.8760058, "lng": -71.3947936}, {"address": "5 Barre Ct", "city": "Warwick", "price": 379900, "predicted_price": 555998.8965517242, "deal_score": 31.7, "beds": 2, "baths": 1, "sqft": 2016.0, "yearBuilt": 1954, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Warwick/5-Barre-Ct-02886/home/51773534", "lat": 41.7040718, "lng": -71.4479449}, {"address": "54 Chatham St", "city": "Providence", "price": 385000, "predicted_price": 559562.7705627705, "deal_score": 31.2, "beds": 3, "baths": 2, "sqft": 2119.0, "yearBuilt": 1920, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/54-Chatham-St-02904/home/51700118", "lat": 41.847879, "lng": -71.4172756}, {"address": "19 Greene Ln", "city": "Newport", "price": 825000, "predicted_price": 1163636.3636363635, "deal_score": 29.1, "beds": 3, "baths": 1.5, "sqft": 1920.0, "yearBuilt": 1930, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Newport/19-Green-Ln-02840/home/51753561", "lat": 41.5028947, "lng": -71.3059766}, {"address": "60 Lowell St", "city": "Cranston", "price": 360000, "predicted_price": 503002.30946882215, "deal_score": 28.4, "beds": 3, "baths": 1, "sqft": 1936.0, "yearBuilt": 1951, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Cranston/60-Lowell-St-02910/home/51841041", "lat": 41.7897588, "lng": -71.4466005}, {"address": "83 Valente Dr", "city": "Cranston", "price": 499000, "predicted_price": 695005.7736720553, "deal_score": 28.2, "beds": 3, "baths": 2, "sqft": 2675.0, "yearBuilt": 1962, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Cranston/83-Valente-Dr-02920/home/51837146", "lat": 41.792265, "lng": -71.4763142}, {"address": "233 California Ave", "city": "Providence", "price": 369000, "predicted_price": 509125.54112554115, "deal_score": 27.5, "beds": 4, "baths": 1.5, "sqft": 1928.0, "yearBuilt": 1940, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/233-California-Ave-02905/home/51726864", "lat": 41.7889761, "lng": -71.3989253}, {"address": "30 Touro St", "city": "Providence", "price": 399900, "predicted_price": 549264.0692640693, "deal_score": 27.2, "beds": 4, "baths": 2, "sqft": 2080.0, "yearBuilt": 1951, "propertyType": "Single Family Residential", "url": "https://www.redfin.com/RI/Providence/30-Touro-St-02904/home/51720793", "lat": 41.8489336, "lng": -71.4186861}];

    function getColor(score) {
      if (score >= 40) return '#22c55e';
      if (score >= 30) return '#888';
      if (score >= 20) return '#666';
      return '#444';
    }

    function formatPrice(p) {
      return '$' + p.toLocaleString();
    }

    deals.forEach(d => {
      if (!d.lat || !d.lng) return;
      
      const color = getColor(d.deal_score);
      const marker = L.circleMarker([d.lat, d.lng], {
        radius: Math.max(8, 6 + d.deal_score / 8),
        fillColor: color,
        color: '#fff',
        weight: 2,
        opacity: 1,
        fillOpacity: 0.85
      }).addTo(map);

      const popup = `
        <div class="deal-popup">
          <span class="status">FOR SALE</span>
          <h3>${d.address}</h3>
          <div>${d.city}</div>
          <div class="price">${formatPrice(d.price)}</div>
          <div class="predicted">Market est: ${formatPrice(Math.round(d.predicted_price))}</div>
          <span class="score">${d.deal_score.toFixed(0)}% below market</span>
          <div class="details">
            ${d.beds || '?'} bed · ${d.baths || '?'} bath · ${d.sqft ? d.sqft.toLocaleString() + ' sqft' : 'N/A'}<br>
            Built ${d.yearBuilt || 'N/A'}
          </div>
          <a href="${d.url}" target="_blank">View on Redfin →</a>
        </div>
      `;
      marker.bindPopup(popup);
    });
  </script>
</body>
</html>